# 의존성 역전하기 

이 챕터에서는 SRP (Single Responsibility Principle) 원칙을 설명하면서 변경에 대한 전파를 얘기한다.

어떠한 모듈이 다른 모듈에 대한 의존성이 생기면 한 모듈이 변경될 때 다른 모듈도 변경될 수 있다는 얘기인데 

이를 기존의 계층형 아키텍처에 적용해보면 도메인 계층은 영속형 계층에 의존적이니까 영속성 계층이 변하면 도메인 계층의 변경에 영향을 줄 수 있다. 뭐 이런 얘기.

그러면서 도메인 계층의 의존성은 영속성 게층의 의존성과 분리되어야 하는게 맞다. 도메인 계층의 변경 이유는 오로지 비즈니스와 관련이 있어야 한다. 는 얘기를 하면서 클린 아키텍처 개념이 나온다. 

클린 아키텍처는 도메인 모델이 가장 안쪽에 있고 그 도메인 모델을 통해서 비즈니스 목표를 달성하는 유스 케이스 그리고 외부와의 통신을 담당하는 웹과 컨트롤러 이렇게 분리된다. 

이 클린 아키텍처를 좀 더 다듬은게 핵사고날 아키텍처 (Hexagonal architecture) 가 있다.

핵사고날 아키텍처는 도메인 모델과 유스 케이스 그리고 외부와의 통신을 담당하는 어댑터로 이뤄져있고 어댑터와 유스 케이스는 각각 포트를 통해서 입력과 출력이 연결된다. 

어댑터에서 바로 도메인 모델로의 접근은 힘들며 도메인 모델의 접근은 유스 케이스를 통해서만 이뤄진다. 

이렇게 하면 다음과 같은 장점을 얻을 수 있다. 

- 도메인 모델은 유스 케이스를 통해서만 접근이 가능하다는 점. 도메인 모델은 어떠한 의존성도 연결되어 있지 않다.

- 유스 케이스가 어플리케이션에서 명확히 구별되서 어떠한 일을 하는지 알 수 있다. 

- 외부에서 들어오는 요청과 나가는 어댑터가 명확하게 구별되서 플로으를 알 수 있다는 점이 있다. 


