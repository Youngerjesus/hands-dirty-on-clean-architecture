# 유스 케이스 구현하기 

여기서는 핵사고날 아키텍처에서 유스 케이스를 구현할 때 고려할 사항을 다룬다. 

유스 케이스가 하는 일은 다음과 같다. 

- 입력 받기 

- 비즈니스 규칙 검증하기 

- 도메인 모델 상태 조작하기 

- 출력 반환하기 

먼저 '입력 받기' 부터 보자.

여기서 입력의 유효성을 유스 케이스에서 구현을 해야할까? 

유스 케이스의 영역에서는 입력의 유효성을 검증하는 것까지는 올바르지 않은 것 같다. 실제로 비즈니스 흐름과 관련이 있기 떄문에.

다만 이 영역을 입력 어댑터의 영역으로 옮겨서 어댑터를 믿기도 올바르지 않은 것 같다. (유스 케이스는 여러 어댑터와 연결될 수 있기 떄문에 놓치는 것이 있을 확률이 있겠지.)

그래서 입력의 유효성은 입력 모델로 옮기는게 나아보인다. 

여기서 입력 모델의 생성자를 써서 검증을 하던가 Java 를 쓰는 경우 Bean Validation API 를 써서 검증할 수도 있겠다. 

비즈니스 규칙 검증을 할 때는 도메인 모델에게 위임해서 검증하는게 좋아보이는데 나는 canExecute/Execute 패턴을 통해서 검증하는 건 어떤가 싶다. 

이러면 캡슐화를 보다 잘 할 수 있지 않을까? 

유스 케이스에서 주의할 사항으로는 입력 모델과 출력 모델을 다른 유스 케이스와 공유하지 않는 것이다. 

다루는 데이터가 유사해서 재사용성을 고려해서 같은 모델을 받도록 생각해 볼 수 있는데 이러면 유스 케이스간의 결합이 높아진다. 

결국 어플리케이션이 발전하면서 유스 케이스마다 구별될 데이터가 생길 건데 이러면 다소 오해의 여지가 생길 수 있다. 

그러므로 유스 케이스에서 입력 모델과 출력으로 반환하는 모델은 구별 하도록 하자. 

마지막으로 읽기만을 하는 유스케이스의 경우에는 어떻게 처리하는게 좋을까? 

읽기만 하는 경우에는 도메인 모델에 접근할 필요가 없다. 

그냥 바로 데이터 조회를 하면 되므로 유스 케이스라고 하기 보다는 '쿼리 서비스' 라고 따로 구별하도록 하자. 

이 경우에는 CQRS (Command-Query-Responsibility-Segregation) 과도 잘 맞는다. 



